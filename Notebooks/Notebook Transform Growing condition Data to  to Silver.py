#!/usr/bin/env python
# coding: utf-8

# ## Notebook Transform Growing condition Data to  to Silver
# 
# New notebook

# In[1]:


# Step 1: Read from Brone Lakehouse using Spark SQL or OneLake shortcut

df_bronze = spark.read.format("delta").load("abfss://dd18648f-6099-472b-9cc8-e045d09f8f4b@onelake.dfs.fabric.microsoft.com/2ba89c3a-f525-4ba0-8bc3-4b150edc193b/Tables/Avocado_growing_conditions_kenya")

#  Step 2 :Data transformation 

# Code generated by Data Wrangler for PySpark DataFrame

from pyspark.ml.feature import Imputer

def clean_data(df_bronze):
    # Replace missing values with the mean of each column in: 'Avg_Temperature', 'Altitude', 'Yield_per_Hectare'
    cols = ['Avg_Temperature', 'Altitude', 'Yield_per_Hectare']
    imputer = Imputer(inputCols=cols, outputCols=cols, strategy='mean')
    df_bronze = imputer.fit(df_bronze).transform(df_bronze)
    return df_bronze

df_bronze_clean = clean_data(df_bronze)
display(df_bronze_clean)

# Step 3: Save cleaned data into Silver layer 
df_bronze_clean.write.mode("overwrite").format("delta").save("Tables/avocado_conditions_silver")


